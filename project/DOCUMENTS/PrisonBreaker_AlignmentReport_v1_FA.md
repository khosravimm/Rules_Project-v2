# PrisonBreaker – گزارش هم‌ترازی وضعیت فعلی با وضعیت ایده‌آل (FA)
meta:
  version: "v1.0.0"
  date: "2025-12-06"
  author: "Analyst (ChatGPT)"
  source: "PrisonBreaker/Rules_Project-v2"

## 1) مقدمه
این سند مقایسه‌ای است بین وضعیت فعلی پروژه PrisonBreaker و وضعیت ایده‌آل تعریف‌شده در سند Ideal State.  
هدف این گزارش، شفاف‌سازی میزان هم‌ترازی (Alignment) بین «آنچه پیاده‌سازی شده» و «آنچه در ذهن طراح پروژه است» می‌باشد.

---

## 2) جدول مقایسه Current vs Ideal vs Gap

| محور | وضعیت فعلی (Current) | وضعیت ایده‌آل (Ideal) | شکاف واقعی (Gap) |
|------|------------------------|------------------------|-------------------|
| Data Pipeline | لودر 4h آماده، داده ۲ سال کامل نیست، فقط BTCUSDT، مانیتورینگ حداقلی | چندبازاره (حداقل ۱۰ بازار)، داده ۲ سال کامل، مانیتورینگ و هشدار خطا | حدود ۶۰٪ فاصله |
| Feature Eng – 5m | پیاده‌سازی نشده | ریزساختار کامل 5m + rolling 1h/4h، آماده برای L1 | حدود ۹۰٪ فاصله |
| Feature Eng – 4h | غنی‌سازی 4h انجام شده ولی بدون L2 mapping و برخی فیچرهای مرجع (مثل CLOSE_POSITION_LAST) | ترکیب OHLC + L2 mapping + فیچرهای کامل هم‌راستا با YAML | حدود ۵۰٪ فاصله |
| L1 Pattern Discovery (5m) | وجود ندارد | ۲۰–۳۰ الگوی معتبر L1 + خوشه‌بندی | حدود ۹۵٪ فاصله |
| L2 Mapping (5m→4h) | پیاده نشده | Mapping کامل 5m→4h با بلوک‌های رفتاری و برچسب‌های توضیحی | حدود ۹۵٪ فاصله |
| 4h Patterns | تعریف شده، ولی support=0 در ارزیاب، عملاً بدون پشتوانه داده | ۱۰–۱۵ الگوی strong و ۲۰–۳۰ medium با support>min و lift>۱.۲ | حدود ۸۰٪ فاصله |
| Evaluator | ماژول 4h با expected_direction موجود؛ اما خروجی meaningful ندارد (support=0) | ارزیاب پایدار برای 4h و 5m، با baseline، تست سلامت و نتایج پایدار | حدود ۷۰٪ فاصله |
| KB Structure | MASTER و DOCS و یک فایل patterns.yaml؛ دوگانگی منبع (rules_4h_patterns.yaml vs patterns.yaml)، layers/system خالی | Canonical KB واحد، لایه/سیستم مستند، عدم دوگانگی ID/منبع | حدود ۵۰٪ فاصله |
| Documentation | اسناد Discovery 4h (FA/EN) و چند گزارش وضعیت وجود دارد | مستندسازی کامل معماری، L1/L2، KB Spec، Evaluator Spec، Rulebook، دو زبانه | حدود ۴۰٪ فاصله |
| Rulebook | وجود ندارد | Rulebook اتوماتیک از روی KB، قابل استفاده برای تریدر | حدود ۹۰٪ فاصله |
| Trading Logic | پیاده‌سازی نشده | قوانین ورود/خروج/invalidations مبتنی بر الگوهای strong/medium | حدود ۹۵٪ فاصله |
| Learning Loop | Miner کنونی وجود ندارد، Evaluator محدود است | Miner هفتگی (L1/L2) + Evaluator روزانه/۴h، نسخه‌گذاری دوره‌ای KB | حدود ۸۰٪ فاصله |
| KPIs | به صورت رسمی تعریف نشده | support/lift/win_rate thresholds مشخص و پایش‌شده | حدود ۹۰٪ فاصله |

---

## 3) جمع‌بندی سطح هم‌ترازی
- در سطح معماری و ساختار (Pipeline، KB، Documentation اولیه)، پروژه تقریباً ۵۰–۶۰٪ در مسیر وضعیت ایده‌آل قرار دارد.  
- در سطح کشف الگوهای معنادار (به‌خصوص L1/L2 و الگوهای 4h با پشتوانه داده)، وضعیت هنوز در فاز ابتدایی است (حدود ۲۰–۳۰٪ مسیر).  
- در سطح استفاده عملیاتی برای ترید (Rulebook + Trading Logic + KPIs پایدار)، پروژه در مراحل آغازین (کمتر از ۱۰٪) است.

این گزارش باید به عنوان قطب‌نما برای اولویت‌بندی گام‌های بعدی استفاده شود:  
ابتدا تثبیت 4h (رفع مشکل support=0، تکمیل فیچرها و KB)، سپس طراحی و پیاده‌سازی L1/L2 و در نهایت ساخت Rulebook و Trading Logic پایدار.

